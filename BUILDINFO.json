{
  "version": "10.0.0-stable-r6-security2",
  "milestone": "v10.0 stable r6 security2",
  "checkpoint": "stable",
  "created_at": "2026-01-09T09:44:49Z",
  "source": {
    "baseline": "origin/main @ 7a179a6 (user-provided)",
    "working_branch": "feat/v9.1-portalization"
  },
  "notes": [
    "Rebased from user-provided v9.1 portalization checkpoint.",
    "Portal index redirects: /admin -> SchoolAdmin, /superadmin -> NetworkAdmin.",
    "Registry-driven desktop sidebar navigation added.",
    "Vault safety: hidden quiz take/editor routes added; pages accept ?quizId= fallback for Vault discovery.",
    "Content protection: LOCKED/DRIP_LOCKED lessons render AccessGate and avoid mounting protected panels.",
    "Tenancy: Subscription added to school-scoped entities.",
    "CI/CD: Added modular GitLab CI kits under .gitlab/ci and fixed scripts/release.ps1 IncludeDist support.",
    "v10.0-r2: Public home redirects authenticated users to /app; login intent keys hardened; registry includes public/legal routes + aliases; LessonViewerPremium now uses useSession + scoped queries.",
    "v10.0-r3: Phase 2 tenancy hardening (pass 1) — Dashboard/Feed/MyProgress now use useSession + scoped queries to prevent cross-school leakage.",
    "v10.0-r4: Phase 2 tenancy hardening (pass 2) — fixed public storefront unscoped id queries (Offer/Transaction/Course/Lesson/Review), allowed secure invite token lookup, hardened scoped helpers to enforce school_id, and migrated entitlement utilities to scoped helpers.",
    "v10.0-r6-security2: Book-9.1 content protection hardening — useLessonAccess is membership-first and no longer fetches Lesson; LessonViewer and LessonViewerPremium load lessonMeta first and fetch full content only when FULL/PREVIEW."
  ]
}
